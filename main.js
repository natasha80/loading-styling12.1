(()=>{var e={624:()=>{const e="ahj-v1",n=["./","./index.html","./main.js","./main.css"];self.addEventListener("install",(t=>{console.log("SW Installed. Cache name:",e),t.waitUntil(caches.open(e).then((e=>e.addAll(n))).then(self.skipWaiting()))})),self.addEventListener("activate",(()=>{console.log("SW activated")})),self.addEventListener("fetch",(e=>{console.log("SW fetchin:",e.request.url),e.respondWith(caches.match(e.request).then((n=>n||fetch(e.request))))}))}},n={};function t(s){var i=n[s];if(void 0!==i)return i.exports;var r=n[s]={exports:{}};return e[s](r,r.exports,t),r.exports}(()=>{"use strict";class e{constructor(){this.idSet=new Set,this.error=null}init(){this.renderContainer(),this.bindToDOM(),this.defaultScreen(),this.addListeners(),this.getData(),this.registerWorker()}registerWorker(){navigator.serviceWorker&&window.addEventListener("load",(async()=>{try{await navigator.serviceWorker.register("./service.worker.js",{scope:"./"}),console.log("service worker registered")}catch(e){console.log("service worker register error: ",e)}}))}renderContainer(){document.body.append(function(){const e=document.createElement("div");return e.classList.add("wrapper"),e.innerHTML='\n  <div class="unit-container">\n    <div class="container__header">\n      <h2 class="widget-header">Новости мира кино</h2>\n      <span class="link">Обновить</span>\n    </div>\n    <ul class="unit-list">\n    </ul>\n    <div class="container__footer">\n    </div>\n  </div>\n    ',e}())}bindToDOM(){this.wrapper=document.querySelector("div.wrapper"),this.refresh=document.querySelector("span.link"),this.unitList=document.querySelector("ul.unit-list"),this.unitContainer=document.querySelector(".unit-container")}defaultScreen(){this.clearList(),this.unitList.prepend(function(){const e=document.createElement("div");for(let n=0;n<3;n+=1)e.innerHTML+='\n  <li class="placeholder-unit">\n    <div class="placeholder-unit__header-block">\n      <span class="placeholder-unit__header-text placeholder-item">&nbsp</span>\n    </div>\n    <div class="placeholder-unit__body">\n      <div class="placeholder-unit__img-block placeholder-item"></div>\n      <div class="placeholder-unit__descr-block">\n        <span class="placeholder-unit__descr-text placeholder-item">&nbsp;</span>\n        <br>\n        <span>&nbsp;</span>\n        <br>\n        <span class="placeholder-unit__descr-text placeholder-item">&nbsp;</span>\n      </div>\n    </div>\n  </li>\n  ';return e}())}addUnit(e){const n=function(e){const{id:n="clear",header:t="&nbsp;",logo:s=""}=e;let{description:i=""}=e,r="",a='\n  <span class="unit__descr-text">&nbsp;</span>\n  <br>\n  <span>&nbsp;</span>\n  <br>\n  <span class="unit__descr-text">&nbsp;</span>\n  ';s&&(r=`<img src="${s}" width="100%" height="100%"></img>`),i&&(i.length>150&&(i=i.substring(0,150),i+="..."),a=`\n    <span class="unit__descr-text">${i}</span>\n    `);const c=document.createElement("li");return c.classList.add("unit"),c.dataset.unitId=n,c.innerHTML=`\n      <div class="unit__header-block">\n        <span class="unit__header-text">${t}</span>\n      </div>\n      <div class="unit__body">\n        <div class="unit__img-block">${r}</div>\n        <div class="unit__descr-block">\n          ${a}\n        </div>\n      </div>\n  `,c}(e);this.unitList.prepend(n)}addListeners(){this.refresh.addEventListener("click",(e=>{e.preventDefault(),this.defaultScreen(),this.getData()}),!1)}clearList(){this.unitList.innerHTML=""}async getData(){try{const e=await fetch("https://vapanov-sw.herokuapp.com/news"),n=await e.json();return"ok"===n.status&&(this.unitContainer.classList.remove("unit-container-offline"),this.clearList(),n.news.forEach((e=>{this.addUnit(e)}))),!0}catch(e){console.error(e)}return this.widgetOffline(),!1}widgetOffline(){[...this.unitList.querySelectorAll(".placeholder-item")].forEach((e=>e.classList.remove("placeholder-item"))),this.unitContainer.classList.add("unit-container-offline")}}(new e).init();t(624)})()})();